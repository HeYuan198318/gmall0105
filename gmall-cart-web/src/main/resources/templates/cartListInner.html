<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Title</title>
    <link rel="stylesheet" href="/css/One_bdyStyle.css" />
    <link rel="stylesheet" href="/css/index.css" />
    <script src="/js/jquery-3.1.1.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="/css/One_mainFoot.css" />
    <link rel="stylesheet" href="/css/font-awesome-4.7.0/css/font-awesome.css" />
</head>
<body>
    <div class="One_ShopCon">
        <ul>
            <li  th:each="cartInfo:${cartList}">
                <div> </div>
                <div>
                    <ol>
                        <li><input type="checkbox"   class="check"  th:value="${cartInfo.productSkuId}"  onchange="checkSku(this)" th:checked="(${cartInfo.isChecked}==1)?'true':'false'" /></li>
                        <li>
                            <dt><img  th:src="${cartInfo.productPic}"  src="img\shop1.jpg" alt="" align="top">
                            <dd  th:onclick="toItem(${cartInfo.productSkuId})" >
                                <p th:onclick="toItem(${cartInfo.productSkuId})">
                                    <span th:text="${cartInfo.productName}" >TCL 55A950C 55英寸32核</span>
                                </p>
                            </dd>
                            </dt>
                        </li>
                        <li>
                            <p class="dj" th:text="'￥'+${cartInfo.price}" >4599.00</p>
                        </li>
                        <li>
                            <p>
                                <span>-</span>
                                <span th:text="${cartInfo.quantity}">5</span>
                                <span>+</span>
                            </p>
                        </li>
                        <li style="font-weight:bold"><p class="zj" th:text="'￥'+${cartInfo.totalPrice}"  >￥22995.00</p></li>
                        <li>
                            <p>删除</p>
                        </li>
                    </ol>
                </div>
            </li>
        </ul>
    </div>
    <div class="One_ShopFootBuy fix1">
        <div>
            <ul>
                <li><input type="checkbox" class="allCheck"><span>全选</span></li>
                <li>删除选中的商品</li>
                <li>移到我的关注</li>
                <li>清除下柜商品</li>
            </ul>
        </div>
        <div>
            <font style="color:#e64346;font-weight:bold;" class="sumNum"> </font>&nbsp;

            <ul>
                <li><img src="img/buyNumleft.png" alt=""></li>
                <li><img src="img/buyNumright.png" alt=""></li>
            </ul>
        </div>
        <div>
            <ol>
                <li>总价:<span style="color:#e64346;font-weight:bold;font-size:16px;" class="fnt">￥0.00</span>  </li>

            </ol>
        </div>
        <div><button  onclick="toTrade()" type="button">去结算</button></div>
    </div>

</body>
<script src="/js/index.js" charset="utf-8"></script>
<script type="text/javascript">

    function toTrade(){
        window.location.href="http://cart.gmall.com:8084/toTrade";



    //子选择框全部选中复选框也选中
    $(".check").click(function(){
        if($(".check[class='check']:checked").length==$(".check[class='check']").length){
            $(".allCheck").prop("checked",true);
        }else{
            $(".allCheck").prop("checked",false)
        }
    })
    //删除已选的商品
    $(".One_ShopFootBuy>div:first-child ul li:nth-child(2)").click(function(){
        // $(".check").each(function(){
        if($(".check").is(":checked")==false){
            $(".One_mb").show();
            $(".One_moveGzIfNull").show();
        }else{
            $(".One_mb").show();     //蒙版显示
            $(".One_isDel").show();  //删除弹框显示
            $(".One_moveGzIfNull").hide();
        }
        //移除结账固定定位
        // if($(".check").length==1){
        // 	$(".fix").remove();
        // }
        // })
        //var that=$(this);
        //确定删除
        /*      $(".One_isDel>div:last-child button:first-child").click(function(){
                  $(".One_mb").hide();    //蒙版隐藏
                  $(".One_isDel").hide(); //删除弹框隐藏
                  $(".check:checked").parent().parent().parent().parent().remove();  //删除选中商品
                  if($(".fix").offset().top>$(".fix1").offset().top){
                      $(".fix").hide();
                  }
                  if($(".check").length==0){
                      $(".allCheck").prop("checked",false);
                      $(".sumNum").html("0");
                      $(".fnt").html("￥ 0.00");
                  }
              })*/
    })
    //确定删除弹框移入我的关注
    $(".One_isDel>div:last-child button:last-child").click(function(){
        $(".One_isDel").hide();
        $(".One_mb").show();
        $(".One_DengLu").show();
    })
    //移到我的关注
    $(".One_ShopFootBuy>div:first-child ul li:nth-child(3)").click(function(){
        $(".check").each(function(index){
            if($(this).is(":checked")==false){
                $(".One_mb").show();
                $(".One_moveGzIfNull").show();
            }else{
                $(".One_mb").show();
                $(".One_moveMyGz").show();
                $(".One_moveGzIfNull").hide();
            }
        })
    })
    //点击×号关闭
    $(".One_moveGzIfNull>p span:last-child img").click(function(){
        $(".One_mb").hide();
        $(".One_moveGzIfNull").hide();
    })
    $(".One_moveMyGz>p span:last-child img").click(function(){
        $(".One_mb").hide();
        $(".One_moveMyGz").hide();
        $(".One_moveGzIfNull").hide();
    })
    $(".One_clearShop>p span:last-child img").click(function(){
        $(".One_mb").hide();
        $(".One_clearShop").hide();
    })
    //移到我的关注取消按钮点击关闭
    $(".One_moveMyGz>div:last-child button:last-child").click(function(){
        $(".One_mb").hide();
        $(".One_moveMyGz").hide();
    })
    //移到我的关注确定按钮点击登录弹框弹出
    $(".One_moveMyGz>div:last-child button:first-child").click(function(){
        $(".One_moveMyGz").hide();
        $(".One_mb").show();
        $(".One_DengLu").show();
    })

    $(".One_DengLu>p:first-child span:last-child img").click(function(){
        $(".One_mb").hide();
        $(".One_DengLu").hide();
    })
    //清除下柜商品
    $(".One_ShopFootBuy>div:first-child ul li:nth-child(4)").click(function(){
        $(".One_mb").show();
        $(".One_clearShop").show()
    })
    //购物车+ -
    //鼠标移入变小手
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(4) p:first-child span").mouseover(function(){
        $(this).css("cursor","pointer")
    })
    //+
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(4) p:first-child span:last-child").click(function(){
        var add=$(this).prev("span").html();
        add++;
        $(this).prev("span").html(add);
        //总价
        var dj=$(this).parent().parent().prev().children(".dj").html().substring(1);
        var sl=$(this).prev("span").html();
        $(this).parent().parent().parent().children("li:nth-child(5)").children(".zj").html("￥"+dj*sl+".00")
        sumSumPrice();

    })
    //-
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(4) p:first-child span:first-child").click(function(){
        var jian=$(this).next("span").html();
        jian--;
        if(jian<=0){
            jian=0;
        }
        $(this).next("span").html(jian);
        //总价
        var dj=$(this).parent().parent().prev().children(".dj").html().substring(1);
        var sl=$(this).next("span").html();
        $(this).parent().parent().parent().children("li:nth-child(5)").children(".zj").html("￥"+dj*sl+".00")
        sumSumPrice();

    })
    //选中当前商品背景变色
    $(".check").each(function(index){
        $(".check").eq(index).click(function(){
            if($(this).is(":checked")){
                $(this).parent().parent().parent().css("background","#fff4e8");
                $(this).parent().parent().parent().parent().children("div:last-child").css("background","#fff4e8")
            }else{
                $(this).parent().parent().parent().parent().children("div:last-child").css("background","none")
                $(this).parent().parent().parent().css("background","none")
            }
        })
    })
    //商品删除鼠标移入变色
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(6) p").mouseover(function(){
        $(this).css({"cursor":"pointer","color":"#e64346"});
    }).mouseout(function(){
        $(this).css({"cursor":"pointer","color":"gray"});
    })
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(6) p:nth-child(2)").click(function(){
        $(".One_mb").show();
        $(".One_moveMyGz").show();
    })
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(6) p:last-child").click(function(){
        $(".One_mb").show();
        $(".One_DengLu").show();
    })
    //点击删除
    //点击删除出现弹框
    $(".One_isDel>p img").click(function(){
        $(".One_mb").hide();
        $(".One_isDel").hide();
    })
    $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(6) p:first-child").click(function(){
        $(".One_mb").show();
        $(".One_isDel").show();
        var that=$(this);
        //确定删除
        /*        $(".One_isDel>div:last-child button:first-child").click(function(){
                    $(".One_mb").hide();
                    $(".One_isDel").hide();
                    that.parent().parent().parent().parent().remove();
                    // 移除结账固定定位
                    // if($(".check").length==1){
                    // 	$(".fix").remove();
                    // }
                    if($(".fix").offset().top>$(".fix1").offset().top){
                        $(".fix").hide();
                    }
                    if($(".check").length==0){
                        $(".allCheck").prop("checked",false);
                        $(".sumNum").html("0");
                        $(".fnt").html("￥ 0.00");
                    }
                })*/
    })
    /*    //页面滚动删除去结算固定定位隐藏
        $(document).scroll(function(){
            if($(".fix").offset().top>$(".fix1").offset().top){
                $(".fix").hide();
            }
        })*/
    $(".One_isDel>div:last-child button").mouseover(function(){
        $(this).css("cursor","pointer");
    })

    $(".One_ShopFootBuy>div:first-child ul li:not(:first-child)").mouseover(function(){
        $(this).css({"cursor":"pointer","color":"#e64346"})
    }).mouseout(function(){
        $(this).css("color","black")
    })

    //封装总价钱函数
    function sumSumPrice(){
        console.log("计算总价");
        var zzj=0;
        $(".check").each(function () {


            if($(this).prop("checked")){
                console.log("check!!"+ $(this).parents("ol").find(".zj").html());
                var zj = $(this).parents("ol").find(".zj").html().substring(1);
                console.log(" 价格："+zj);
                zzj=zzj+parseFloat(zj);
            }
            $(".fnt").html("￥"+zzj+".00")
        })

        /*        $(".One_ShopCon ul li>div:nth-child(2) ol li:nth-child(5) .zj").each(function(){
                    kong+=parseFloat($(this).html().substring(1))
                })
                $(".fnt").html("￥"+kong+".00")*/
    }
    //封装总数量函数
    function sumSumNum(){
        var kong=0;
        $(".One_ShopCon ul li>div:nth-child(2) ol>li:nth-child(4) p:first-child span:nth-child(2)").each(function(){
            kong+=parseFloat($(this).html())
        })
        $(".sumNum").html(kong);
    }

    $(".One_ShopCon ul li>div:nth-child(2)>ol>li:nth-child(2)>dd").mouseover(function(){
        $(this).css({"cursor":"pointer","color":"#e64346"})
    }).mouseout(function(){
        $(this).css("color","black")
    })
    //更多促销下拉
    $(".One_ShopCon ul li>div:nth-child(2) ol li:nth-child(3) p:nth-child(2)").click(function(){
        $(this).parent().children(".nmbd").slideToggle(300);
        var dis=$(this).parent().children(".nmbd").css("display");
        console.log(dis);
        // if(dis=="block"){
        // 	$(".hahaha").css("transform","rotateX(-180deg)")
        // }else{
        // 	$(".hahaha").css("transform","rotateX(360deg)")
        // }
    })
    $(".nmbd dd:last-child button:first-child").click(function(){
        $(this).parent().parent().slideUp(100)
    })
    $(".nmbd dd:last-child button:last-child").click(function(){
        $(this).parent().parent().slideUp(100)
    })










    //active
    $(".one_main_div1 .one_main_ul>li").mouseover(function(){
        $(".one_main_div1 .one_main_ul>li").removeClass("active");
        $(this).addClass("active");
    })
    //选项卡
    $(".one_main_div1 .one_main_ul li").mouseover(function() {
        $(".one_main_div1_1").eq($(this).index()).stop(true).show().siblings().stop(true).hide()
    })

    $(function() {
        //声明变量记录索引
        var index = 0;
        //点击右边按钮
        //忽略重复点击开关
        var toggle = true
        $(".arrow-right").click(function() {

            if (toggle == false) {
                return
            }
            toggle = false
            index++;
            if (index > $('.fade li').length - 1) {
                index = 0;
            }

        });

        //点击左边按钮
        $(".arrow-left").click(function() {
            if (toggle == false) {
                return
            }
            toggle = false
            index--;
            if (index < 0) {
                index = $('.fade li').length - 1;
            }
            $('.pagination ul li').eq(index).addClass('active').siblings().removeClass('active')
            $(".slider>ul>li").eq(index).fadeIn(500, function() {
                toggle = true
            }).siblings("li").fadeOut(500);
        });
        //点击分页器
        $('.pagination ul li').mouseover(function() {
            var paging = $(this).index()
            //变颜色
            $(this).addClass('active').siblings().removeClass('active')
            //与图片关联
            $(".slider>ul>li").eq(paging).fadeIn(1000).siblings("li").fadeOut(1000);

        })
    });
    $(".fade li>div a").mouseover(function(){
        $(this).children("p").children("img").attr("src","img/one_mian_gwc2.png")
    }).mouseout(function(){
        $(this).children("p").children("img").attr("src","img/one_mian_gwc1.png")
    })
</script>
</html>